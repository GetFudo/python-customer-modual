{"query": {"bool": {"must": [{"match": {"status": 1}}, {"match": {"storeCategoryId": "5cc0846e087d924456427975"}}], "should": [{"match_phrase_prefix": {"pName.en": {"analyzer": "standard", "query": "blouses ", "boost": 5}}}, {"match_phrase": {"pName.en": {"analyzer": "standard", "query": "blouses ", "boost": 5}}}, {"match": {"pName.en": {"query": "blouses ", "boost": 5}}}, {"match_phrase_prefix": {"units.unitName.en": {"analyzer": "standard", "query": "blouses ", "boost": 6}}}, {"match": {"units.unitName.en": {"query": "blouses ", "boost": 6}}}, {"match": {"detailDescription.en": {"query": "blouses ", "boost": 4}}}, {"match_phrase_prefix": {"detailDescription.en": {"query": "blouses ", "boost": 4}}}, {"match": {"categoryList.parentCategory.childCatgory.categoryName.en": {"query": "blouses ", "boost": 3}}}, {"match_phrase_prefix": {"categoryList.parentCategory.childCatgory.categoryName.en": {"query": "blouses ", "boost": 3}}}, {"match": {"categoryList.parentCategory.categoryName.en": {"query": "blouses ", "boost": 2}}}, {"match_phrase_prefix": {"categoryList.parentCategory.categoryName.en": {"query": "blouses ", "boost": 2}}}, {"match": {"brandTitle.en": {"query": "blouses ", "boost": 1}}}, {"match_phrase_prefix": {"brandTitle.en": {"query": "blouses ", "boost": 1}}}], "must_not": [{"match": {"storeId": "0"}}], "minimum_should_match": 1, "boost": 1.0}}, "track_total_hits": True, "sort": [{"isCentral": {"order": "desc"}}, {"isInStock": {"order": "desc"}}, {"units.discountPrice": {"order": "asc"}}, {"_score": {"order": "desc"}}], "aggs": {"group_by_sub_category": {"terms": {"field": "parentProductId.keyword", "order": {"avg_score": "desc"}, "size": 10}, "aggs": {"avg_score": {"max": {"script": "_score"}}, "top_sales_hits": {"top_hits": {"sort": [{"isCentral": {"order": "desc"}}, {"isInStock": {"order": "desc"}}, {"units.discountPrice": {"order": "asc"}}, {"_score": {"order": "desc"}}], "_source": {"includes": ["_id", "_score", "pName", "storeId", "parentProductId", "currencySymbol", "prescriptionRequired", "needsIdProof", "saleOnline", "uploadProductDetails", "currency", "firstCategoryName", "secondCategoryName", "brandTitle", "pPName", "tax", "brandTitle", "categoryList", "images", "avgRating", "units", "storeCategoryId", "manufactureName", "maxQuantity"]}, "size": 1}}}}}}